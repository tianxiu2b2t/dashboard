# 更新外键约束以支持级联删除

**1. 概述**

本次数据库迁移旨在为多个相关表的外键约束添加级联删除功能。当 `app_info` 表中的应用记录被删除时，相关的历史数据、评分数据和指标数据也会被自动删除，确保数据的一致性和完整性。

**2. 变更详情**

本次迁移更新以下表的外键约束：

*   **`app_data_history`**: 应用数据历史表
*   **`app_rating_history`**: 应用评分历史表  
*   **`app_metrics`**: 应用指标表
*   **`app_rating`**: 应用评分表

**3. 具体操作**

为上述所有表的外键约束添加 `ON DELETE CASCADE` 选项：

- 当 `app_info` 表中的记录被删除时
- 所有引用该 `app_id` 的相关记录也会被自动删除
- 这确保了数据完整性和一致性

**4. 执行顺序**

请严格按照以下顺序执行脚本：

1.  **`001_update_foreign_keys.sql`**: 更新所有相关表的外键约束，添加级联删除功能

**5. 注意事项**

- 此迁移为破坏性操作，执行前请务必备份数据
- 级联删除功能会删除相关数据，请确保这是期望的行为
- 如果存在大量数据，删除操作可能需要较长时间
- 建议在业务低峰期执行此迁移